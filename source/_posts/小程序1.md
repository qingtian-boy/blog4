---
title: 小程序1
date: 2019-01-25 11:39:52
tags: 小程序
---
# 目录

[TOC]

# 一、知识路径

- 小程序基本介绍
- 帐号和设置
- 开发工具和模拟器
- 应用案例：实现第一个小程序
- 小程序的文件结构与配置
- 事件
- 视图结构wxml
- 小程序样式

==目标：能够注册小程序帐号，并且掌握小程序中的基本组成结构和相关语法==
## 7、视图结构 wxml

### 7.1、概述

官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/quickstart/basic/file.html#wxml-%E6%A8%A1%E6%9D%BF

​	从事过网页编程的人知道，网页编程采用的是 HTML + CSS + JS 这样的组合，其中 HTML 是用来描述当前这个页面的结构， CSS 用来描述页面的样子， JS 通常是用来处理这个页面和用户的交互。

同样道理，在小程序中也有同样的角色，其中 ==WXML 充当的就是类似 HTML 的角色==。打开 pages/index/index.wxml，你会看到以下的内容：

![1548231914849](1548231914849.png)

和 HTML 非常相似， WXML 由标签、属性等等构成。但是也有很多不一样的地方，我们来一一阐述一下：

1）标签名字有点不一样

2）多了一些 ==wx:if== 这样的属性以及 =={ { } }==(插值表达式)这样的表达式

我们把 <view>...</view> 标签称为视图容器。

### 7.2、数据绑定

官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/data.html

通过 =={ {} }==的语法(插值表达式)把一个变量绑定到界面上，我们称为数据绑定。

​	小程序提倡把渲染和逻辑分离，简单来说就是不要再让 JS 直接操控 DOM，JS 只需要管理状态即可，然后再通过一种模板语法来描述状态和界面结构的关系即可。

WXML语法：
```html
<标签>{ {变量名} }</标签>
```
<!-- more -->
**示例：**

1. 首先得在页面的 *.js 文件中定义数据变量，例如：index 页面中
![1548234168649](1548234168649.png)
2. 然后才可以在以wxml为后缀的文件中使用

![1548234474359](1548234474359.png)

3.效果如下图所示

![1548234492012](1548234492012.png)

### 7.3、列表渲染

官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/list.html

==语法：wx:for==

1）wx:for-index 可以指定数组当前下标的变量名，默认名为 index

2）wx:for-item 可以指定数组当前元素的变量名，默认名为 item

3）wx:key 可以定义也可以不定义，唯一的标识符

**示例：**

1.首先在 .js后缀的文件中设定数组数据

![1548234935027](1548234935027.png)

2.然后在 .wxml为后缀的模板文件中使用列表渲染相当于循环遍历出userData的数据

![1548235735555](1548235735555.png)

3.效果如下图所示

![1548235788570](1548235788570.png)

### 7.4、条件渲染

官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/conditional.html

==语法：wx:if==

在框架中，使用 wx:if="{ {condition}
}" 来判断是否需要渲染该代码块；也可以用 wx:elif 和 wx:else 来添加一个 else块。

==快速生成一个小程序页面的方法：==

在==微信提供的开发工具==中，打开 `app.json`，直接在 `app.json`中的`pages`配置项里增加一个新页面的路径：

![1548236052235](1548236052235.png)

然后直接保存该文件，那么在系统开发工具中立即就能自动帮我们生成这个页面

![1548236101111](1548236101111.png)

**示例：**

1.在 .js 文件中添加一个数据变量

![1548236248729](1548236248729.png)

2.然后直接在 .wxml 模板页面中使用条件渲染

![1548236621015](1548236621015.png)

当前为v1类设置样式：

![1548236699910](1548236699910.png)

3.效果如下图所示

![1548236734903](1548236734903.png)

### 7.5、模板
官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/template.html

WXML 提供模板(template)，可以在模板中定义代码片段，然后在不同的地方调用。

定义模板使用 name 属性，作为模板的名字。然后在 <template> 标签内定义代码片段。

**示例1：不加载变量**

1.在 .wxml 为后缀的文件中构建如下代码

![1548237188646](1548237188646.png)

2.效果如下图所示

![1548237223824](1548237223824.png)

**示例2：加载变量**

1.首先在 .js 为后缀的文件中新增两个变量，分别保存具有同名的属性 json 对象

![1548237414313](1548237414313.png)

2.在 .wxml 中定义 temmplate 模板并且加载变量

![1548237666195](1548237666195.png)

3.效果如下图所示

![1548237691463](1548237691463.png)

### 7.5、引用

官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/import.html

WXML 提供两种文件引用方式 import 和 include

两者的区别

1）include 相当复制一份代码过来，而 import 是导入引用

2）include 可以嵌套，而 import 是不可以嵌套

**示例：**

演示 include 可以嵌套：

1.在 pages 目录下创建一个新的目录 common，同时在该目录下分别创建两个模板文件 c1.wxml 和 c2.wxml

代码分别如下：

c1.wxml

![1548240515138](1548240515138.png)

c2.wxml

![1548240281505](1548240281505.png)

2.在 /pages/template/template.wxml 中使用 include 方式引入 c1.wxml

![1548240553843](1548240553843.png)

3.效果如下图所示

![1548240576829](1548240576829.png)

3）import 需要定义模板(template)来调用，而 include 直接写 wxml 标签

**示例：**

1.在 /pages/common 目录下创建名为 c3.wxml 的文件，代码如下

![1548241300795](1548241300795.png)

2.在 /pages/template/template.wxml 中使用 import 的方式引入 c3.wxml 文件，并且调用 c3.wxml 中的 template

![1548241393171](1548241393171.png)

​	从最终的效果，我们发现通过 import 引入的文件，文件中的内容需要 template 包裹才有效，引入之后需要使用 template 来调用引入文件中的内容。

## 8、小程序样式
官方开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html

### 8.1、概述

WXSS 用来决定 WXML 的组件应该怎么显示。说白了就是样式

为了适应广大的前端开发者，WXSS具有 CSS 大部分特性。同时为了更适合开发微信小程序，WXSS 对 CSS 进行了扩充以及修改。

1）新增了尺寸单位

WXSS 在底层支持新的尺寸单位 rpx，开发者可以免去换算的烦恼，只要交给小程序底层来换算即可，由于换算采用的浮点数运算，所以运算结果会和预期结果有一点点偏差。

2）提供了全局的样式和局部样式

我们可以写一个 app.wxss 作为全局样式，会作用于当前小程序的所有页面，局部页面样式 page.wxss 仅对当前页面生效。

3）此外 WXSS 仅支持==部分 CSS==选择器

### 8.2、内联样式

style：style 接收动态的样式，在运行时会进行解析，请尽量避免将静态的样式写进 style 中，以免影响渲染速度。

==注意：静态的样式建议统一写到 .wxss 后缀文件中。==

**示例：**

1.一般情况下，静态样式写在 .wxss 文件中设置

![1548242490278](1548242490278.png)

==注意：页面初始状态下具有的样式属性我们把它称为静态样式，这些静态样式建议写进 wxss 文件中，提升加载和渲染的效率。==

2.动态样式则可以直接在 .wxml 文件中标签中进行设置

例如：

![1548242693629](1548242693629.png)

### 8.3、选择器

目前支持的选择器有：

| 选择器           | 样例           | 样例描述                                      |
| ---------------- | -------------- | --------------------------------------------- |
| .class           | .intro         | 选择所有拥有 class="intro" 的组件             |
| #id              | #firstname     | 选择拥有 id="firstname" 的组件                |
| element          | view           | 选择所有 view 组件                            |
| element，element | view，checkbox | 选择所有文档的 view 组件和所有的 checkbox组件 |
| ::after          | view::after    | 在 view 组件后边插入内容                      |
| ::before         | view::before   | 在 view 组件前边插入内容                      |

**示例：**

![1548242939323](1548242939323.png)

### 8.4、尺寸单位
==rpx==(responsive pixel)：可以根据屏幕宽度进行自适应。

规定屏幕宽为 750rpx。例如在 iPhone6上，屏幕宽度为 375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。

| 设备         | rpx 换算 px (屏幕宽度/750) | px 换算 rpx (750/屏幕宽度) |
| ------------ | -------------------------- | -------------------------- |
| iPhone5      | 1rpx = 0.42px              | 1px = 2.34rpx              |
| iPhone6      | 1rpx = 0.5px               | 1px = 2rpx                 |
| iPhone6 Plus | 1rpx = 0.552px             | 1px = 1.81rpx              |

> 建议：开发微信小程序时设计师可以用 ==iPhone6==作为视觉稿的标准。
>
> 注意：在较小的屏幕上不可避免的会有一些毛刺，请在开发时尽量避免这种情况
>
> ==在日后的小程序开中，我们的统一的单位是 rpx 不要使用 px 作为单位==

### 8.5、全局样式与局部样式

#### 8.5.1、全局样式

定义在 app.wxss 中的样式为全局样式，作用于每一个页面

![1548243959179](1548243959179.png)

#### 8.5.2、局部样式

在 pages 的 wxss 文件中定义的样式为局部样式，只作用在对应的页面，并会覆盖 app.wxss 中相同的选择器。

![1548244102457](1548244102457.png)

### 8.6、样式导入

使用==@import==语句可以导入外联样式表，==@import==后跟需要导入的外联样式表的相对路径，用 ==;== 表示语句结束。

![1548244216103](1548244216103.png)

![1548244445065](1548244445065.png)
## 9、总结

小程序是什么

注册小程序

小程序与APP区别

​	小程序依赖微信，无需下载与安装，不用考虑兼容问题

​	APP独立安装，需要考虑兼容问题

文件结构

​	比较重要：app.js、app.json、app.wxss(可有可无)

​	pages

​		index

​			四个文件：index.js、index.wxml、index.json(可有可无)、index.wxss(可有可无)

​		logs

生命周期

视图结构

​	数据绑定

​		{ {变量名} }  插值表达式

​	列表渲染

​		wx:for

​		<block wx:for="{ {变量} }" wx:key="唯一标识(自定义)" wx:for-index="自定义下标" wx:for="变量名称(自定义)">

​			....

​		</block>

​	条件渲染

​		<block wx:if="{ {条件表达式1} }">

​			<!-- 条件表达式1 -->

​		</block>

​		<block wx:elif="{ {条件表达式2} }">

​			<!-- 条件表达式2 -->

​		</block>

​			<block wx:else>

​			<!-- else -->

​		</block>

​	模板

```html
<!-- 自定义模板 -->
<template name="自定义(模板名称)">
	...
</template>
<!-- 引用 -->
<template is="模板名称"></template>

<!--引入-->
<!-- include、import -->
```

样式

​	内联样式

```html
<view style="内联样式"></view>
```

​	静态样式

​		把样式写到文件后缀名为 .wxss 文件

​	选择器

​		class、id、标签(组件)

​	全局样式

​		app.wxss

​	pages/目录(index)/index.wxss文件，称为局部

​	样式导入

```css
@import '文件路径+文件名'; /*注意：被引入文件不需要带后缀名*/
```
